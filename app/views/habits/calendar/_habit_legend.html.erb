<!-- Habit Legend with Alpine.js for toggle interactions -->
<div x-data="{ 
       habits: [],
       visibleHabits: []
     }"
     @fullcalendar:habits-loaded.window="habits = $event.detail.habits"
     class="bg-white rounded-2xl shadow-soft p-6">
  <div class="flex items-center justify-between mb-4">
    <h3 class="text-lg font-semibold text-text-primary">Active Habits</h3>
    <button @click="$dispatch('toggle-all-habits')" 
            class="text-sm text-primary-600 hover:text-primary-700 transition-colors duration-200">
      Toggle All
    </button>
  </div>
  
  <div class="space-y-3">
    <template x-for="habit in habits" :key="habit.id">
      <div @click="$dispatch('toggle-habit', { habitId: habit.id })"
           class="flex items-center justify-between p-3 rounded-lg border border-gray-100 hover:bg-gray-50 transition-colors duration-200 cursor-pointer">
        <div class="flex items-center space-x-3 flex-1">
          <div class="w-4 h-4 rounded-full flex-shrink-0" :style="`background-color: ${habit.color}`"></div>
          <div class="flex-1 min-w-0">
            <p class="text-sm font-medium text-text-primary truncate" x-text="habit.name"></p>
            <div class="flex items-center gap-3 text-xs text-text-secondary mt-0.5">
              <span>
                <span x-text="habit.completion_count"></span>/<span x-text="habit.total_days"></span> days
              </span>
              <span class="flex items-center gap-1" x-show="habit.current_streak > 0">
                <i class="fas fa-fire text-accent-600"></i>
                <span x-text="habit.current_streak"></span>
              </span>
            </div>
          </div>
        </div>
        <i class="fas fa-eye text-text-secondary flex-shrink-0"></i>
      </div>
    </template>
    
    <!-- Empty state -->
    <div x-show="habits.length === 0" class="text-center py-4">
      <p class="text-sm text-text-secondary">No active habits found</p>
      <%= link_to "Create your first habit", habits_items_path, class: "text-primary-600 hover:text-primary-700 text-sm font-medium" %>
    </div>
  </div>
</div>
